# Variables

引用变量：

* 添加变量：

在playbook中使用vars: 添加变量，如下：
```yaml
[root@blog playbooks]# cat vars.yml 
- hosts: test
  remote_user: root
  vars:
  - package: httpd
  - service: httpd
  tasks:
    - name: install httpd package
      yum: name={{ package }} state=latest
    - name: install configuration file for httpd
      copy: src=/opt/httpd.conf dest=/etc/httpd/conf/httpd.conf
      notify:
       - restart httpd
    - name: start httpd service
      service: enabled=true name={{ service }} state=started
  handlers:
    - name: restart httpd
      service: name={{ service }} state=restarted
```

```bash
[root@blog playbooks]# ansible-playbook vars.yml --syntax-check

playbook: vars.yml

[root@blog playbooks]# ansible-playbook vars.yml 

PLAY [test] ***************************************************************************************************************************************************************************************************************************************

TASK [Gathering Facts] ****************************************************************************************************************************************************************************************************************************
ok: [192.168.1.44]

TASK [install httpd package] **********************************************************************************************************************************************************************************************************************
ok: [192.168.1.44]

TASK [install configuration file for httpd] *******************************************************************************************************************************************************************************************************
ok: [192.168.1.44]

TASK [start httpd service] ************************************************************************************************************************************************************************************************************************
ok: [192.168.1.44]

PLAY RECAP ****************************************************************************************************************************************************************************************************************************************
192.168.1.44               : ok=4    changed=0    unreachable=0    failed=0  
```


* 直接引用ansible变量：

    ansible_all_ipv4_addresses获取IP


```bash
[root@blog playbooks]# vim ansible_vars.yml
[root@blog playbooks]# cat ansible_vars.yml
- hosts: test
  remote_user: root
  tasks:
    - name: copy file
      copy: content="{{ansible_all_ipv4_addressed}}," dest=/opt/vars.txt

[root@blog playbooks]# ansible-playbook ansible_vars.yml --syntax-check

playbook: ansible_vars.yml

[root@blog playbooks]# ansible-playbook ansible_vars.yml

PLAY [test] ***************************************************************************************************************************************************************************************************************************************

TASK [Gathering Facts] ****************************************************************************************************************************************************************************************************************************
ok: [192.168.1.44]

TASK [copy file] **********************************************************************************************************************************************************************************************************************************
changed: [192.168.1.44]

PLAY RECAP ****************************************************************************************************************************************************************************************************************************************
192.168.1.44               : ok=2    changed=1    unreachable=0    failed=0   

[root@blog playbooks]# cat /opt/vars.txt 
([u'192.168.1.44'],)
```

* 引用主机变量： 在组的主机后面添加变量；

```yaml
[root@blog playbooks]# cat /opt/vars.txt 
[u'192.168.1.44'],test.ansible.com[root@blog playbooks]# cat host-vars.yml 
- hosts: test
  remote_user: root
  tasks:
    - name: copy file
      copy: content="{{ ansible_all_ipv4_addresses }},{{ hostname }}" dest=/opt/vars.txt
```

```bash
# 主机变量与ansible变量混合使用；
[root@blog playbooks]# ansible-playbook host-vars.yml 

PLAY [test] ***************************************************************************************************************************************************************************************************************************************

TASK [Gathering Facts] ****************************************************************************************************************************************************************************************************************************
ok: [192.168.1.44]

TASK [copy file] **********************************************************************************************************************************************************************************************************************************
changed: [192.168.1.44]

PLAY RECAP ****************************************************************************************************************************************************************************************************************************************
192.168.1.44               : ok=2    changed=1    unreachable=0    failed=0   

[root@blog playbooks]# cat /opt/vars.txt 
[u'192.168.1.44'],test.ansible.com
```