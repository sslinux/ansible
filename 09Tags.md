# 09Tags

在一个playbook中，我们一般会定义很多个task，如果我们只想执行其中的某一个task或多个task时就可以使用tags标签功能了

```yml
[root@blog playbooks]# vim tags1.yml
[root@blog playbooks]# cat tags1.yml
- hosts: test
  remote_user: root
  tasks:
    - name: Copy hosts file
      copy: src=/etc/hosts dest=/etc/hosts
      tags:
      - only    # 定义only标签
    - name: touch file
      file: path=/opt/hosts state=touch
```

```bash
[root@blog playbooks]# ansible-playbook tags1.yml --tags="only"   # 只执行only这个标签上面的任务；

PLAY [test] ***************************************************************************************************************************************************************************************************************************************

TASK [Gathering Facts] ****************************************************************************************************************************************************************************************************************************
ok: [192.168.1.44]

TASK [Copy hosts file] ****************************************************************************************************************************************************************************************************************************
ok: [192.168.1.44]

PLAY RECAP ****************************************************************************************************************************************************************************************************************************************
192.168.1.44               : ok=2    changed=0    unreachable=0    failed=0   
```

* 事实上，不光可以为单个或多个task指定同一个tags。playbook还提供了一个特殊的tags为always。作用就是当使用always当tags的task时，无论执行哪一个tags时，定义有always的tags都会执行。


```yml
[root@blog playbooks]# vim tags_always.yml
[root@blog playbooks]# cat tags_always.yml
- hosts: test
  remote_user: root
  tasks:
    - name: Copy hosts file
      copy: src=/etc/hosts dest=/etc/hosts
      tags:
      - only
    - name: touch file
      file: path=/opt/hosts state=touch
      tags:
      - always
```

```bash
# 无论执行那个tags上面的task， always tags上面的task都会被执行；
[root@blog playbooks]# ansible-playbook tags_always.yml --tags="only"

PLAY [test] ***************************************************************************************************************************************************************************************************************************************

TASK [Gathering Facts] ****************************************************************************************************************************************************************************************************************************
ok: [192.168.1.44]

TASK [Copy hosts file] ****************************************************************************************************************************************************************************************************************************
ok: [192.168.1.44]

TASK [touch file] *********************************************************************************************************************************************************************************************************************************
changed: [192.168.1.44]

PLAY RECAP ****************************************************************************************************************************************************************************************************************************************
192.168.1.44               : ok=3    changed=1    unreachable=0    failed=0   
```